---
#
##
### Written by the CAT (Cloudwatt Automation Team)
##
#
- hosts: local
  user: cloud
  become: true

  tasks:

    - name: post-install playbook directory is created
      file:
        path=/root/mail-install
        state=directory
        owner=root
        group=root
        mode=0700


    - name: post-install playbook is uploaded
      copy:
        src="{{ item.src }}"
        dest="{{ item.dest }}"
        owner="{{ item.owner }}"
        mode="{{ item.mode }}"
      with_items:

        - { src: 'mail-conf/mail-install.yml', dest: '/root/mail-install/mail-install.yml', owner: 'root', mode: "600"}
        - { src: 'mail-conf/master.cf', dest: '/root/mail-install/master.cf', owner: 'root', mode: "600"}
        - { src: 'mail-conf/main.cf.j2', dest: '/root/mail-install/main.cf.j2', owner: 'root', mode: "600"}
        - { src: 'mail-conf/vhost.conf.j2', dest: '/root/mail-install/vhost.conf.j2', owner: 'root', mode: "600"}
        - { src: 'mail-conf/10-master.conf', dest: '/root/mail-install/10-master.conf', owner: 'root', mode: "600"}


